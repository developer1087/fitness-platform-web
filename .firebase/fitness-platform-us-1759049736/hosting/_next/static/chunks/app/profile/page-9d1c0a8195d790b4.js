(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{4345:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>u});var a=s(5155),t=s(2115),i=s(8576),l=s(1914),o=s(9253),n=s(8134),d=s(4585),c=s(7886);function u(){let{user:e}=(0,i.A)(),r=(0,t.useRef)(null),[s,u]=(0,t.useState)({firstName:"",lastName:"",email:(null==e?void 0:e.email)||"",phone:"",bio:"",specializations:["Strength Training","Weight Loss"],certifications:["NASM-CPT","ACSM-CPT"],experience:5,hourlyRate:80}),[m,x]=(0,t.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[h,g]=(0,t.useState)((null==e?void 0:e.photoURL)||null),[f,p]=(0,t.useState)(null),[b,y]=(0,t.useState)(!1),[w,j]=(0,t.useState)(!1),[v,N]=(0,t.useState)(!1),[P,k]=(0,t.useState)(!1),[C,S]=(0,t.useState)(!(null==e?void 0:e.emailVerified)),[L,U]=(0,t.useState)({}),[E,z]=(0,t.useState)("");if((0,t.useEffect)(()=>{if(e){let[r,...s]=(e.displayName||"").split(" "),a=s.join(" ");u(s=>{var t,i;return{...s,firstName:(null==(t=e.profile)?void 0:t.firstName)||r||"",lastName:(null==(i=e.profile)?void 0:i.lastName)||a||"",email:e.email||""}}),g(e.photoURL||null),S(!e.emailVerified)}},[e]),!e)return(0,a.jsx)("div",{children:"Loading..."});let R=(e,r)=>{u(s=>({...s,[e]:r})),L[e]&&U(r=>({...r,[e]:""}))},M=async r=>{if(!d.IG)throw Error("Firebase Storage not initialized. Please check your Firebase configuration.");if(!(null==e?void 0:e.uid))throw Error("User not authenticated");let s=await A(r),a=(0,n.KR)(d.IG,"profile-pictures/".concat(e.uid,"/").concat(Date.now(),"-").concat(s.name));try{let e=await (0,n.D)(a,s);return await (0,n.qk)(e.ref)}catch(e){var t;if(console.error("Error uploading image to Firebase Storage:",e),(null==e?void 0:e.code)==="storage/unknown"||(null==e||null==(t=e.message)?void 0:t.includes("CORS")))throw Error("Firebase Storage is not properly configured. Please contact support or try again later.");if((null==e?void 0:e.code)==="storage/unauthorized")throw Error("Permission denied. Please check your authentication and try again.");if((null==e?void 0:e.code)==="storage/quota-exceeded")throw Error("Storage quota exceeded. Please try with a smaller image.");else throw Error("Upload failed: ".concat((null==e?void 0:e.message)||"Unknown error",". Please try again."))}},A=async e=>new Promise(r=>{let s=document.createElement("canvas"),a=s.getContext("2d"),t=new Image;t.onload=()=>{let{width:i,height:l}=t;i>l?i>800&&(l=800*l/i,i=800):l>800&&(i=800*i/l,l=800),s.width=i,s.height=l,a.drawImage(t,0,0,i,l),s.toBlob(s=>{s?r(new File([s],e.name,{type:"image/jpeg",lastModified:Date.now()})):r(e)},"image/jpeg",.7)},t.src=URL.createObjectURL(e)}),F=(e,r)=>{x(s=>({...s,[e]:r})),L[e]&&U(r=>({...r,[e]:""}))},I=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={};return!e&&(s.firstName.trim()||(r.firstName="First name is required"),s.lastName.trim()||(r.lastName="Last name is required")),s.phone&&!/^\+?[\d\s-()]+$/.test(s.phone)&&(r.phone="Please enter a valid phone number"),s.hourlyRate<0&&(r.hourlyRate="Hourly rate must be positive"),U(r),0===Object.keys(r).length},B=async function(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(I(r)){y(!0),z("");try{if(!(null===d.j2||void 0===d.j2?void 0:d.j2.currentUser)||!(null==e?void 0:e.uid))throw Error("No authenticated user found");let r=d.j2.currentUser,a="".concat(s.firstName," ").concat(s.lastName),t={};if(e.displayName!==a&&(t.displayName=a),f){j(!0);try{t.photoURL=await M(f),p(null)}catch(e){console.error("Error uploading image:",e),U({general:"Failed to upload image. Please try again."});return}finally{j(!1)}}Object.keys(t).length>0&&await (0,o.r7)(r,t),await c.y.updateUserProfile(e.uid,{firstName:s.firstName,lastName:s.lastName}),console.log("Profile data saved successfully:",s),z("Profile updated successfully!")}catch(e){console.error("Profile update error:",e),U({general:e.message||"Failed to update profile"})}finally{y(!1)}}},q=async()=>{if((()=>{let e={};return m.currentPassword||(e.currentPassword="Current password is required"),m.newPassword?m.newPassword.length<6&&(e.newPassword="Password must be at least 6 characters"):e.newPassword="New password is required",m.newPassword!==m.confirmPassword&&(e.confirmPassword="Passwords do not match"),U(e),0===Object.keys(e).length})()){y(!0),z("");try{if(!d.j2)throw Error("Firebase Auth not initialized");let r=o.IX.credential(e.email,m.currentPassword);await (0,o.kZ)(d.j2.currentUser,r),await (0,o.f3)(d.j2.currentUser,m.newPassword),x({currentPassword:"",newPassword:"",confirmPassword:""}),k(!1),z("Password updated successfully!")}catch(e){"auth/wrong-password"===e.code?U({currentPassword:"Current password is incorrect"}):U({general:e.message||"Failed to update password"})}finally{y(!1)}}},T=async()=>{y(!0);try{if(!(null===d.j2||void 0===d.j2?void 0:d.j2.currentUser))throw Error("No authenticated user found");await (0,o.gA)(d.j2.currentUser),N(!0),z("Verification email sent! Please check your inbox and refresh the page after verifying."),setTimeout(async()=>{(null===d.j2||void 0===d.j2?void 0:d.j2.currentUser)&&(await d.j2.currentUser.reload(),d.j2.currentUser.emailVerified&&(S(!1),z("Email verified successfully!")))},5e3)}catch(e){U({general:e.message||"Failed to send verification email"})}finally{y(!1)}};return(0,a.jsxs)(l.A,{currentPage:"profile",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Profile Settings"})})}),(0,a.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[E&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-md",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-green-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,a.jsx)("p",{className:"text-sm text-green-800",children:E})]})}),L.general&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,a.jsx)("p",{className:"text-sm text-red-800",children:L.general})}),C&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-yellow-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,a.jsx)("p",{className:"text-sm text-yellow-800",children:v?"Verification email sent! Please check your inbox and verify your email address.":"Your email address is not verified. Please verify your email to secure your account."})]}),!v&&(0,a.jsx)("button",{onClick:T,disabled:b,className:"ml-4 px-3 py-1 bg-yellow-100 text-yellow-800 rounded-md hover:bg-yellow-200 transition-colors text-sm font-medium disabled:opacity-50",children:b?"Sending...":"Send Verification"})]})}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Profile Picture"}),(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsx)("div",{className:"w-24 h-24 bg-gray-200 rounded-full overflow-hidden",children:h?(0,a.jsx)("img",{src:h,alt:"Profile",className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full bg-gray-300 flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-12 h-12 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>{var e;return null==(e=r.current)?void 0:e.click()},disabled:w,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:w?"Uploading...":"Upload New Picture"}),h&&!w&&(0,a.jsx)("button",{onClick:()=>{g(null),p(null)},className:"ml-2 text-gray-600 hover:text-gray-800",children:"Remove"}),(0,a.jsx)("input",{ref:r,type:"file",accept:"image/*",onChange:e=>{var r;let s=null==(r=e.target.files)?void 0:r[0];if(s){if(!s.type.startsWith("image/"))return void U(e=>({...e,image:"Please select a valid image file"}));if(s.size>0xa00000)return void U(e=>({...e,image:"Image size must be less than 10MB"}));p(s);let e=new FileReader;e.onload=e=>{var r;g(null==(r=e.target)?void 0:r.result),U(e=>({...e,image:""}))},e.readAsDataURL(s)}},className:"hidden"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"JPG, GIF or PNG. Max size 10MB. Images will be uploaded to secure cloud storage."}),L.image&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.image})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),(0,a.jsx)("input",{type:"text",value:s.firstName,onChange:e=>R("firstName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),L.firstName&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),(0,a.jsx)("input",{type:"text",value:s.lastName,onChange:e=>R("lastName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),L.lastName&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.lastName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,a.jsx)("input",{type:"email",value:s.email,onChange:e=>R("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50",disabled:!0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Email changes require special authentication. Contact support to change your email."}),L.email&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,a.jsx)("input",{type:"tel",value:s.phone,onChange:e=>R("phone",e.target.value),placeholder:"+1 (555) 123-4567",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),L.phone&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.phone})]})]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),(0,a.jsx)("textarea",{value:s.bio,onChange:e=>R("bio",e.target.value),rows:4,placeholder:"Tell your clients about yourself, your training philosophy, and experience...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Professional Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Years of Experience"}),(0,a.jsx)("input",{type:"number",min:"0",value:s.experience,onChange:e=>R("experience",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hourly Rate ($)"}),(0,a.jsx)("input",{type:"number",min:"0",value:s.hourlyRate,onChange:e=>R("hourlyRate",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),L.hourlyRate&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.hourlyRate})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Specializations"}),(0,a.jsxs)("div",{className:"space-y-2",children:[s.specializations.map((e,r)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{var s;return s=e.target.value,void u(e=>({...e,specializations:e.specializations.map((e,a)=>a===r?s:e)}))},placeholder:"e.g., Strength Training, Weight Loss, Athletic Performance",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("button",{onClick:()=>{u(e=>({...e,specializations:e.specializations.filter((e,s)=>s!==r)}))},className:"text-red-600 hover:text-red-800",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},r)),(0,a.jsx)("button",{onClick:()=>{u(e=>({...e,specializations:[...e.specializations,""]}))},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"+ Add Specialization"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Certifications"}),(0,a.jsxs)("div",{className:"space-y-2",children:[s.certifications.map((e,r)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{var s;return s=e.target.value,void u(e=>({...e,certifications:e.certifications.map((e,a)=>a===r?s:e)}))},placeholder:"e.g., NASM-CPT, ACSM-CPT, NSCA-CSCS",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("button",{onClick:()=>{u(e=>({...e,certifications:e.certifications.filter((e,s)=>s!==r)}))},className:"text-red-600 hover:text-red-800",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},r)),(0,a.jsx)("button",{onClick:()=>{u(e=>({...e,certifications:[...e.certifications,""]}))},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"+ Add Certification"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Security"}),P?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),(0,a.jsx)("input",{type:"password",value:m.currentPassword,onChange:e=>F("currentPassword",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),L.currentPassword&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.currentPassword})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,a.jsx)("input",{type:"password",value:m.newPassword,onChange:e=>F("newPassword",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),L.newPassword&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.newPassword})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),(0,a.jsx)("input",{type:"password",value:m.confirmPassword,onChange:e=>F("confirmPassword",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),L.confirmPassword&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:L.confirmPassword})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:q,disabled:b,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:b?"Updating...":"Update Password"}),(0,a.jsx)("button",{onClick:()=>{k(!1),x({currentPassword:"",newPassword:"",confirmPassword:""}),U({})},className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"})]})]}):(0,a.jsx)("button",{onClick:()=>k(!0),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors",children:"Change Password"})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{onClick:()=>B(),disabled:b||w,className:"bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 font-medium",children:b?"Saving...":w?"Uploading Image...":"Save Profile"})})]})]})]})}},8811:(e,r,s)=>{Promise.resolve().then(s.bind(s,4345))}},e=>{e.O(0,[992,416,914,533,441,493,358],()=>e(e.s=8811)),_N_E=e.O()}]);