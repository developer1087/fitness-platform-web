(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{63:(e,t,r)=>{"use strict";var s=r(7260);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},5915:(e,t,r)=>{"use strict";r.d(t,{g:()=>o});var s=r(9708),i=r(4585);let a="trainee_invitations",n="trainees";function l(){let e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}class o{static async inviteTrainee(e,t){try{if(!i.db)throw Error("Firebase Firestore not initialized");let o=(0,s.P)((0,s.rJ)(i.db,n),(0,s._M)("trainerId","==",e),(0,s._M)("email","==",t.email));if(!(await (0,s.GG)(o)).empty)throw Error("A trainee with this email already exists");let d=(0,s.P)((0,s.rJ)(i.db,a),(0,s._M)("trainerId","==",e),(0,s._M)("email","==",t.email),(0,s._M)("status","==","pending"));if(!(await (0,s.GG)(d)).empty)throw Error("An invitation is already pending for this email");let c=l(),m=new Date,x=new Date(m.getTime()+6048e5),h={trainerId:e,email:t.email,firstName:t.firstName,lastName:t.lastName,fitnessLevel:t.fitnessLevel,goals:t.goals||[],notes:t.notes,status:"pending",inviteToken:c,invitedAt:m.toISOString(),expiresAt:x.toISOString()},u=await (0,s.gS)((0,s.rJ)(i.db,a),h),g={trainerId:e,email:t.email,firstName:t.firstName,lastName:t.lastName,joinDate:m.toISOString(),status:"pending",fitnessLevel:t.fitnessLevel||"beginner",goals:t.goals||[],notes:t.notes,totalSessions:0,invitationId:u.id};await (0,s.gS)((0,s.rJ)(i.db,n),g);try{var r;let e=(null===i.j2||void 0===i.j2||null==(r=i.j2.currentUser)?void 0:r.displayName)||"Your Trainer";fetch("/api/email/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({traineeEmail:t.email,trainerName:e,traineeFirstName:t.firstName,invitationToken:c})}).then(async e=>{if(!e.ok){let t=await e.text();console.warn("Invitation email API responded with non-OK:",t)}}).catch(e=>{console.warn("Invitation email API call failed:",e)})}catch(e){console.error("Error initiating invitation email:",e)}return u.id}catch(e){throw console.error("Error inviting trainee:",e),e}}static async getTraineesByTrainer(e){try{if(!i.db)throw Error("Firebase Firestore not initialized");let t=(0,s.P)((0,s.rJ)(i.db,n),(0,s._M)("trainerId","==",e),(0,s.My)("joinDate","desc")),r=await (0,s.GG)(t),a=[];return r.forEach(e=>{a.push({id:e.id,...e.data()})}),a}catch(e){throw console.error("Error getting trainees:",e),e}}static async getTraineeById(e){try{if(!i.db)throw Error("Firebase Firestore not initialized");let t=(0,s.H9)(i.db,n,e),r=await (0,s.x7)(t);if(r.exists())return{id:r.id,...r.data()};return null}catch(e){throw console.error("Error getting trainee:",e),e}}static async updateTrainee(e,t){try{if(!i.db)throw Error("Firebase Firestore not initialized");let r=(0,s.H9)(i.db,n,e);await (0,s.mZ)(r,{...t,updatedAt:new Date().toISOString()})}catch(e){throw console.error("Error updating trainee:",e),e}}static async deleteTrainee(e){try{if(!i.db)throw Error("Firebase Firestore not initialized");let t=(0,s.H9)(i.db,n,e),r=await (0,s.x7)(t);if(!r.exists())return;{let e=r.data(),n=e.trainerId,l=e.email;if(await (0,s.kd)(t),n&&l){let e=(0,s.P)((0,s.rJ)(i.db,a),(0,s._M)("trainerId","==",n),(0,s._M)("email","==",l)),t=await (0,s.GG)(e),r=[];t.forEach(e=>{r.push((0,s.kd)(e.ref))}),r.length>0&&await Promise.all(r)}}}catch(e){throw console.error("Error deleting trainee:",e),e}}static async getInvitationByToken(e){try{if(!i.db)throw Error("Firebase Firestore not initialized");let t=(0,s.P)((0,s.rJ)(i.db,a),(0,s._M)("inviteToken","==",e),(0,s._M)("status","==","pending")),r=await (0,s.GG)(t);if(r.empty)return null;let n=r.docs[0],l={id:n.id,...n.data()};if(new Date(l.expiresAt)<new Date)return await this.expireInvitation(l.id),null;return l}catch(e){throw console.error("Error getting invitation by token:",e),e}}static async acceptInvitation(e,t){try{if(!i.db)throw Error("Firebase Firestore not initialized");let r=(0,s.H9)(i.db,a,e);await (0,s.mZ)(r,{status:"accepted",acceptedAt:new Date().toISOString()});let l=(0,s.P)((0,s.rJ)(i.db,n),(0,s._M)("invitationId","==",e)),o=await (0,s.GG)(l);if(!o.empty){let e=o.docs[0],r=(0,s.H9)(i.db,n,e.id);await (0,s.mZ)(r,{userId:t,status:"active",updatedAt:new Date().toISOString()})}}catch(e){throw console.error("Error accepting invitation:",e),e}}static async expireInvitation(e){try{if(!i.db)throw Error("Firebase Firestore not initialized");let t=(0,s.H9)(i.db,a,e);await (0,s.mZ)(t,{status:"expired"})}catch(e){throw console.error("Error expiring invitation:",e),e}}static async resendInvitation(e){try{if(!i.db)throw Error("Firebase Firestore not initialized");let t=l(),r=new Date(Date.now()+6048e5),n=(0,s.H9)(i.db,a,e);return await (0,s.mZ)(n,{inviteToken:t,status:"pending",expiresAt:r.toISOString(),resentAt:new Date().toISOString()}),t}catch(e){throw console.error("Error resending invitation:",e),e}}static async getPendingInvitations(e){try{if(!i.db)throw Error("Firebase Firestore not initialized");let t=(0,s.P)((0,s.rJ)(i.db,a),(0,s._M)("trainerId","==",e),(0,s._M)("status","==","pending"),(0,s.My)("invitedAt","desc")),r=await (0,s.GG)(t),n=[];return r.forEach(e=>{n.push({id:e.id,...e.data()})}),n}catch(e){throw console.error("Error getting pending invitations:",e),e}}}},7375:(e,t,r)=>{Promise.resolve().then(r.bind(r,8973))},8973:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),i=r(2115),a=r(8576),n=r(1914),l=r(63),o=r(5915);function d(){let e=(0,l.useParams)(),{user:t}=(0,a.A)(),r=null==e?void 0:e.id,[d,c]=(0,i.useState)("overview"),[m,x]=(0,i.useState)(null),[h,u]=(0,i.useState)(!0),[g,b]=(0,i.useState)(null),[y,p]=(0,i.useState)(!1),[f,j]=(0,i.useState)(!1);(0,i.useEffect)(()=>{r&&(null==t?void 0:t.uid)&&v()},[r,t]);let v=async()=>{if(r){u(!0),b(null);try{let e=await o.g.getTraineeById(r);e?x(e):b("Trainee not found")}catch(e){console.error("Error loading trainee:",e),b("Failed to load trainee details")}finally{u(!1)}}};return t?h?(0,s.jsx)(n.A,{currentPage:"trainees",children:(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-8 w-8 text-blue-600 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading trainee details..."})]})})}):g||!m?(0,s.jsx)(n.A,{currentPage:"trainees",children:(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("svg",{className:"w-12 h-12 text-red-500 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,s.jsx)("p",{className:"mt-2 text-red-600 font-medium",children:g||"Trainee not found"}),(0,s.jsx)("a",{href:"/trainees",className:"mt-4 inline-block text-blue-600 hover:text-blue-800",children:"← Back to Trainees"})]})})}):(0,s.jsxs)(n.A,{currentPage:"trainees",children:[(0,s.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("a",{href:"/trainees",className:"text-gray-500 hover:text-gray-700 mr-4",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:[m.firstName," ",m.lastName]}),(0,s.jsx)("span",{className:"ml-3 px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{let t={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",trial:"bg-blue-100 text-blue-800"};return t[e]||t.inactive})(m.status)),children:m.status})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>p(!0),className:"bg-white text-gray-700 border border-gray-300 px-4 py-2 rounded-md hover:bg-gray-50 transition-colors",children:"Edit Profile"}),(0,s.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors",children:"Schedule Session"})]})]})})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-start gap-6",children:[(0,s.jsx)("div",{className:"w-24 h-24 bg-gray-200 rounded-full overflow-hidden",children:m.profilePicture?(0,s.jsx)("img",{src:m.profilePicture,alt:"".concat(m.firstName," ").concat(m.lastName),className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full bg-gray-300 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-12 h-12 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),(0,s.jsxs)("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Contact Information"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm text-gray-900",children:m.email}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Phone: Not set"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Physical Stats"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Age: Not set"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Height: Not set"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Weight: Not set"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Training Info"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-900",children:["Level: ",m.fitnessLevel]}),(0,s.jsxs)("p",{className:"text-sm text-gray-900",children:["Sessions: ",m.totalSessions]}),(0,s.jsxs)("p",{className:"text-sm text-gray-900",children:["Joined: ",new Date(m.joinDate).toLocaleDateString()]})]})]})]})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Fitness Goals"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:m.goals.map((e,t)=>(0,s.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:e},t))})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsx)("nav",{className:"-mb-px flex",children:[{key:"overview",label:"Overview"},{key:"sessions",label:"Session History"},{key:"payments",label:"Payments"},{key:"notes",label:"Notes"}].map(e=>(0,s.jsx)("button",{onClick:()=>c(e.key),className:"py-3 px-6 border-b-2 font-medium text-sm ".concat(d===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.label},e.key))})}),(0,s.jsxs)("div",{className:"p-6",children:["overview"===d&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Notes"}),(0,s.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,s.jsx)("p",{className:"text-gray-900",children:m.notes||"No notes available"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Emergency Contact & Medical Info"}),(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:(0,s.jsx)("p",{className:"text-yellow-700 text-sm",children:"\uD83D\uDCDD Emergency contact and medical information features will be implemented in the next update."})})]})]}),"sessions"===d&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Session History"}),(0,s.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Schedule New Session"})]}),(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:(0,s.jsxs)("p",{className:"text-blue-700 text-sm",children:["\uD83D\uDCC5 Session management features will be implemented in the next update. You can currently track total sessions: ",(0,s.jsx)("strong",{children:m.totalSessions})]})})]}),"payments"===d&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Payment History"}),(0,s.jsx)("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:(0,s.jsx)("p",{className:"text-green-700 text-sm",children:"\uD83D\uDCB3 Payment management features will be implemented in the next update. This will include payment tracking, invoicing, and revenue analytics."})})]}),"notes"===d&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Trainer Notes"}),(0,s.jsx)("button",{onClick:()=>j(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Add Note"})]}),(0,s.jsx)("div",{className:"bg-purple-50 border border-purple-200 p-4 rounded-lg",children:(0,s.jsxs)("p",{className:"text-purple-700 text-sm",children:["\uD83D\uDCDD Advanced note management will be implemented in the next update. Currently showing basic notes from trainee profile: ",(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:m.notes||"No notes available"})]})})]})]})]})]}),y&&(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Trainee Profile"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Profile editing functionality will be implemented next."}),(0,s.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,s.jsx)("button",{onClick:()=>p(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Coming Soon"})]})]})})}),f&&(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add Note"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Note functionality will be implemented next."}),(0,s.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,s.jsx)("button",{onClick:()=>j(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>j(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Coming Soon"})]})]})})})]}):(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-8 w-8 text-blue-600 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})})}}},e=>{e.O(0,[992,416,914,533,441,493,358],()=>e(e.s=7375)),_N_E=e.O()}]);